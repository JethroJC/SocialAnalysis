{% extends 'SA/person_base.html' %}

{% block list %}
    <a href="{% url 'SA:person_info' %}" class="list-group-item active"><h4>基本信息</h4></a>
    <br>
    <a href="{% url 'SA:person_info' %}" class="list-group-item active"><h4>关注列表</h4></a>
    {% for f in follows %}
    <div class="list-group-item">
        <a href='{% url 'SA:person_detail' f.id %}'><h4>{{ f.tag_name }}</h4></a>
    </div>
    {% endfor %}
    <br>
    <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#add_person_modal">添加关注</button>

{% endblock %}

{% block content %}
    <div class="row clearfix">
		<div class="col-md-12 column">
			<table class="table table-hover">
				<tbody>
					<tr>
						<td>
                            <h3>
                                用户头像
                            </h3>
						</td>
                        <td>

						</td>
						<td>

						</td>
                        <td>

						</td>
						<td>
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
							<img onerror="this.src='/media/head/default.jpg'" src="{{ img_path }}"height="60" width="60"  class="img-circle" />
						</td>
					</tr>
					<tr class="success">
						<td>
                            <h3>
                                用户名
                            </h3>
						</td>
						<td>

						</td>
						<td>

						</td>
                        <td>

						</td>
						<td>
                            <br>
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp;
                            <font size="5">
							{{ name }}
                            </font>
						</td>
					</tr>
					<tr class="info">
						<td>
                            <h3>
							    邮箱
                            </h3>
						</td>
						<td>

						</td>
						<td>

						</td>
                        <td>

						</td>
						<td>
                            <br>
							&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            <font size="5">
                            {{ email }}
                            </font>
						</td>
					</tr>
					<tr class="warning">
						<td>
							<h3>
                                性别
                            </h3>
						</td>
						<td>

						</td>
						<td>

						</td>
                        <td>

						</td>
						<td>
                            <br>
							&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            <font size="5">
                            {{ sex }}
                            </font>
						</td>
					</tr>

				</tbody>
			</table>
		</div>
	</div>


    <div id="add_person_modal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
        <div class="modal-content text-center">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">添加关注</h4>
            </div>
            <div class="modal-body">
                <form id="add_person_form" class="form-horizontal" method="post">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="username" class="col-sm-2 control-label">用户名</label>
                        <div class="col-sm-10">
                            <input id="username" type="text" class="form-control" name="username" value="">
                        </div>
                    </div>
                    <h4>
                        微博信息
                    </h4>
                    <div class="form-group">
                        <label for="inputPassword3" class="col-sm-2 control-label">主页地址</label>
                        <div class="col-sm-10">
                            <input  class="form-control" id="weibo_homepage_url" name="weibo_homepage_url"/>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="inputPassword3" class="col-sm-2 control-label">用户id</label>
                        <div class="col-sm-10">
                            <input  class="form-control" id="weibo_id" name="weibo_id"/>
                        </div>
                    </div>

                    <h4>
                        知乎信息
                    </h4>

                    <div class="form-group">
                        <label for="inputPassword3" class="col-sm-2 control-label">主页地址</label>
                        <div class="col-sm-10">
                            <input class="form-control" id="zhihu_homepage_url" name="zhihu_homepage_url"/>
                        </div>
                    </div>


                    <h4>
                        贴吧信息
                    </h4>

                    <div class="form-group">
                        <label for="inputPassword3" class="col-sm-2 control-label">用户名</label>
                        <div class="col-sm-10">
                            <input class="form-control" id="zhihu_homepage_url" name="tieba_username"/>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-sm-10">
                            <button id="add_person_button" type="button" class="btn btn-primary">添加</button>
                        </div>
                    </div>
                </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
          </div>
        </div>
      </div>
    </div>

    <script>
        $(document).ready(function(){
            $('#add_person_button').on('click',function(){
                let person_info = $('#add_person_form').serialize();
                $.ajax({
                    url: "{% url 'SA:add_person' %}",
                    type: 'post',
                    datatype: 'json',
                    data: person_info,
                    async: false,
                    success: function(ret) {
                        if(ret.status === "success"){
                            alert("添加成功");
                            window.location.href = '{% url 'SA:person_info' %}';
                            window.event.returnValue = false;
                            //window.location = 'http://127.0.0.1:8000/SA/home';
                            //Response.Redirect("http://127.0.0.1:8000/SA/home",true);
                        }
                        else
                        {
                            $('#login_form').find('input').each(function () {$(this).val("");});
                            alert("输入信息有误");
                        }
                    }
                });
            });
        });
    </script>
{% endblock %}